<html>
<head>
<title>Радіо Закарпаття ФМ</title>
 <script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Play::latin,cyrillic' ] }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })(); </script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" ></script>

  <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>


<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="refresh" content="9"> 
</head>

<body bgcolor="#3a3c3d" width="100%" height="100%" text="#000000">
<div align="center">
<br>
<table width="100%" border="0" id="table1" bordercolor="#666666">
  <tr bgcolor="#6b0a0a" bordercolor="#999999"> 
    <td> 
      <div align="center"><font FACE="Play" size="-1" color="#adadad"><b>Тепер грає:</b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-1" color="#adadad"><b>Виконавець</b></div>
    </td>
  </tr>
  <tr bordercolor="#999999"> 
    <td> 
      <div align="center"><font FACE="Play" size="-2" color="#adadad"><b>I'm On Your Side</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2" color="#adadad"><b>Th Express</b></font></div>
    </td>
  </tr>
</table>
<HR>
<p align="center"><b><font FACE="Play" color="#adadad">Далі в ефірі:</font></b></p>
<table width="100%" border="0" id="table2" align="center" bordercolor="#adadad">
  <tr bgcolor="#6b0a0a"> 
    <td>&nbsp;</td>
    <td> 
      <div align="center"><font FACE="Play" size="-1"><b><font FACE="Play" color="#adadad">Назва пісні</font></b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-1"><b><font FACE="Play" color="#adadad">Виконавець</font></b></font></div>
    </td>
  </tr>



  <tr> 
    <td> 
      <div align="center"><b><font FACE="Play" size="-2" color="#adadad">1</font></b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2" color="#adadad"><b>В твоей голове</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2" color="#adadad"><b>Дима Билан</b></font></div>
    </td>
  </tr>

  <tr> 
    <td> 
      <div align="center"><b><font FACE="Play" size="-2"color="#adadad">2</font></b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Send My Love(To Your New Lover)</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Adele</b></font></div>
    </td>
  </tr>
  <tr> 
    <td> 
      <div align="center"><b><font FACE="Play" size="-2"color="#adadad">3</font></b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>I Do</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Lisa Loeb</b></font></div>
    </td>
  </tr>
  <tr> 
    <td> 
      <div align="center"><b><font FACE="Play" size="-2"color="#adadad">4</font></b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Північна (Northern Dance)</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Руслана</b></font></div>
    </td>
  </tr>
  <tr> 
    <td> 
      <div align="center"><b><font FACE="Play" size="-2"color="#adadad">5</font></b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Hey Baby</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Dj Otzi</b></font></div>
    </td>
  </tr>
  <tr> 
    <td> 
      <div align="center"><b><font FACE="Play" size="-2"color="#adadad">6</font></b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Твои Глаза</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Loboda</b></font></div>
    </td>
  </tr>
  <tr> 
    <td> 
      <div align="center"><b><font FACE="Play" size="-2"color="#adadad">7</font></b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Так, Як Ти</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Red Sofa</b></font></div>
    </td>
  </tr>
  <tr> 
    <td> 
      <div align="center"><b><font FACE="Play" size="-2"color="#adadad">8</font></b></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>A Little Bit Of Sunshine</b></font></div>
    </td>
    <td> 
      <div align="center"><font FACE="Play" size="-2"color="#adadad"><b>Reamonn</b></font></div>
    </td>
  </tr>



</table>
</div>
<p><b></b></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>



<script type="text/javascript">

var TableDataCur = new Array();    
$('#table1 tr').each(function(row, tr){
    if(row > 0 ){
      TableDataCur[row]={
        "song" :$(tr).find('td:eq(0) b').text()
        ,"artist" : $(tr).find('td:eq(1) b').text(),
        "changed" : false
      }
    }   
}); 
TableDataCur.shift(); 
stringTableCur = JSON.stringify(TableDataCur);



var TableData = new Array();    
$('#table2 tr').each(function(row, tr){
      if(row > 0 && row <= 6){
      TableData[row]={

          "id" : $(tr).find('td:eq(0) b').text()
          , "song" :$(tr).find('td:eq(1) b').text()
          , "artist" : $(tr).find('td:eq(2) b').text()
        } 
      }    
   
}); 
TableData.shift(); 
stringTable = JSON.stringify(TableData);



hash = function (str) {
  var hash = 0;
  var str = String(str);
  if (str.length == 0) return hash;
  for (i = 0; i < str.length; i++) {
    char = str.charCodeAt(i);
    hash = ((hash<<5)-hash)+char;
    hash = hash & hash; // Convert to 32bit integer
  }
  return hash;
}


console.log($.cookie('nextsonghash'));
console.log(String(hash(stringTable)));

var socket = io('http://185.65.245.45:7080');
if($.cookie('nextsonghash') !== String(hash(stringTable))) {
  console.log(1);
  $.cookie('nextsonghash', String(hash(stringTable)));
 
  socket.on('getList', function (data) {
    socket.emit('playlist', stringTable);
  });  
}



if($.cookie('nextsonghashCur') !== String(hash(stringTableCur))) {
  console.log('Cur');
  $.cookie('nextsonghashCur', String(hash(stringTableCur)));

  TableDataCur[0].changed = true;
  console.log(TableDataCur);
  stringTablet = JSON.stringify(TableDataCur);
    console.log(stringTablet);

  socket.emit('songchanged', stringTablet); 
}
else {
  socket.emit('songchanged', stringTableCur);
}

</script>